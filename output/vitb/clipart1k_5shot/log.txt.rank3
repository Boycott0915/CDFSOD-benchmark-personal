[12/22 19:54:16] detectron2 INFO: Rank of current process: 3. World size: 4
[12/22 19:54:17] detectron2 INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.9.23 | packaged by conda-forge | (main, Jun  4 2025, 17:57:12) [GCC 13.3.0]
numpy                   1.22.4
detectron2              RegionCLIP @/data2/user/2025/flf/project_zyh/CDFSOD-benchmark/tools/../detectron2
Compiler                GCC 10.5
CUDA compiler           CUDA 11.8
detectron2 arch flags   8.6
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.13.1+cu117 @/home/fee/sdb_flf/miniconda3/envs/cdfsod/lib/python3.9/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0,1,2,3             NVIDIA GeForce RTX 4090 (arch=8.9)
CUDA_HOME               /usr/local/cuda-11.8
Pillow                  9.5.0
torchvision             0.14.1+cu117 @/home/fee/sdb_flf/miniconda3/envs/cdfsod/lib/python3.9/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.5.post20221221
iopath                  0.1.8
cv2                     Not found
----------------------  ----------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.9.7  (built against CUDA 11.8)
    - Built with CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[12/22 19:54:17] detectron2 INFO: Command line arguments: Namespace(config_file='configs/clipart1k/vitb_shot5_clipart1k_finetune.yaml', resume=False, eval_only=False, num_gpus=4, controller=False, num_machines=1, machine_rank=0, dist_url='auto', opts=['MODEL.WEIGHTS', 'weights/trained/few-shot/vitb_0089999.pth', 'DE.OFFLINE_RPN_CONFIG', 'configs/RPN/mask_rcnn_R_50_C4_1x_ovd_FSD.yaml', 'OUTPUT_DIR', 'output/vitb/clipart1k_5shot/'])
[12/22 19:54:17] detectron2 INFO: Contents of args.config_file=configs/clipart1k/vitb_shot5_clipart1k_finetune.yaml:
_BASE_: ../Base-RCNN-C4.yaml
DE:
  CLASS_PROTOTYPES: prototypes_init/clipart1k_5shot.vitb14.bbox.p5.sk.pkl
  BG_PROTOTYPES: weights/initial/background/background_prototypes.vitb14.pth
  BG_CLS_LOSS_WEIGHT: 0.2
  TOPK: 5
  SET_CD_VITO: true
  ATTN_FUSE_RATIO: 0.7
MODEL:
  META_ARCHITECTURE: OpenSetDetectorWithExamples
  BACKBONE:
    NAME: build_dino_v2_vit
    TYPE: base    # base, small
  WEIGHTS: ''
  MASK_ON: false
  RPN:
    HEAD_NAME: StandardRPNHead
    IN_FEATURES: [res4]
  ROI_HEADS:
    SCORE_THRESH_TEST: 0.001
  ROI_BOX_HEAD:
    NAME: ''
    NUM_FC: 0
    POOLER_RESOLUTION: 7
    CLS_AGNOSTIC_BBOX_REG: true
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
DATASETS:
  TRAIN: ("clipart1k_5shot",)
  TEST: ("clipart1k_test",)
TEST:
  EVAL_PERIOD: 250
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.002
  STEPS: (100, 180)
  MAX_ITER: 250
  WARMUP_ITERS: 50
  CHECKPOINT_PERIOD: 250
INPUT:
  MIN_SIZE_TRAIN_SAMPLING: choice
  MIN_SIZE_TRAIN: (640, 672, 704, 736, 768, 800)
  MAX_SIZE_TRAIN: 1333
  MIN_SIZE_TEST: 800
  MAX_SIZE_TEST: 1333
  FORMAT: RGB


[12/22 19:54:23] detectron2.data.datasets.coco INFO: Loaded 92 images in COCO format from datasets/clipart1k/annotations/5_shot.json
[12/22 19:54:23] detectron2.data.build INFO: Removed 0 images with no usable annotations. 92 images left.
[12/22 19:54:23] detectron2.data.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
|   sheep    | 5            |    chair    | 5            |    boat     | 5            |
|   bottle   | 5            | diningtable | 5            |    sofa     | 5            |
|    cow     | 5            |  motorbike  | 5            |     car     | 5            |
| aeroplane  | 5            |     cat     | 5            |    train    | 5            |
|   person   | 5            |   bicycle   | 5            | pottedplant | 5            |
|    bird    | 5            |     dog     | 5            |     bus     | 5            |
| tvmonitor  | 5            |    horse    | 5            |             |              |
|   total    | 100          |             |              |             |              |[0m
[12/22 19:54:23] detectron2.data.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[12/22 19:54:23] detectron2.data.build INFO: Using training sampler TrainingSampler
[12/22 19:54:24] detectron2.data.common INFO: Serializing 92 elements to byte tensors and concatenating them all ...
[12/22 19:54:24] detectron2.data.common INFO: Serialized dataset takes 0.02 MiB
[12/22 19:54:24] fvcore.common.checkpoint INFO: [Checkpointer] Loading from weights/trained/few-shot/vitb_0089999.pth ...
[12/22 19:54:25] fvcore.common.checkpoint WARNING: Skip loading parameter 'test_class_weight' to the model due to incompatible shapes: (80, 768) in the checkpoint but (20, 768) in the model! You might want to double check if this is expected.
[12/22 19:54:25] fvcore.common.checkpoint WARNING: Some model parameters or buffers are not found in the checkpoint:
[34madapter.proto_center_attn.attention_weights.0.{bias, weight}[0m
[34madapter.proto_center_attn.fc.{bias, weight}[0m
[34mbg_tokens.weight[0m
[34mclass_weights.weight[0m
[34mdomain_prompter.weight[0m
[34mprototype_classifier.linear.{bias, weight}[0m
[34mtest_class_weight[0m
[12/22 19:54:25] fvcore.common.checkpoint WARNING: The checkpoint state_dict contains keys that are not used by the model:
  [35mtrain_class_weight[0m
[12/22 19:54:25] detectron2.engine.train_loop INFO: Starting training from iteration 0
[12/22 19:59:08] detectron2.engine.hooks INFO: Overall training speed: 248 iterations in 0:04:35 (1.1092 s / it)
[12/22 19:59:08] detectron2.engine.hooks INFO: Total training time: 0:04:35 (0:00:00 on hooks)
[12/22 19:59:08] detectron2.data.datasets.coco INFO: Loaded 500 images in COCO format from datasets/clipart1k/annotations/test.json
[12/22 19:59:08] detectron2.data.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
|   sheep    | 33           |    chair    | 163          |    boat     | 74           |
|   bottle   | 74           | diningtable | 50           |    sofa     | 21           |
|    cow     | 21           |  motorbike  | 10           |     car     | 84           |
| aeroplane  | 41           |     cat     | 23           |    train    | 26           |
|   person   | 566          |   bicycle   | 16           | pottedplant | 94           |
|    bird    | 124          |     dog     | 24           |     bus     | 8            |
| tvmonitor  | 40           |    horse    | 34           |             |              |
|   total    | 1526         |             |              |             |              |[0m
[12/22 19:59:08] detectron2.data.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[12/22 19:59:08] detectron2.data.common INFO: Serializing 500 elements to byte tensors and concatenating them all ...
[12/22 19:59:08] detectron2.data.common INFO: Serialized dataset takes 0.18 MiB
[12/22 19:59:08] detectron2.evaluation.evaluator INFO: Start inference on 125 batches
[12/22 22:08:26] detectron2 INFO: Rank of current process: 3. World size: 4
[12/22 22:08:27] detectron2 INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.9.23 | packaged by conda-forge | (main, Jun  4 2025, 17:57:12) [GCC 13.3.0]
numpy                   1.22.4
detectron2              RegionCLIP @/data2/user/2025/flf/project_zyh/CDFSOD-benchmark/tools/../detectron2
Compiler                GCC 10.5
CUDA compiler           CUDA 11.8
detectron2 arch flags   8.6
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.13.1+cu117 @/home/fee/sdb_flf/miniconda3/envs/cdfsod/lib/python3.9/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0,1,2,3             NVIDIA GeForce RTX 4090 (arch=8.9)
CUDA_HOME               /usr/local/cuda-11.8
Pillow                  9.5.0
torchvision             0.14.1+cu117 @/home/fee/sdb_flf/miniconda3/envs/cdfsod/lib/python3.9/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.5.post20221221
iopath                  0.1.8
cv2                     Not found
----------------------  ----------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.9.7  (built against CUDA 11.8)
    - Built with CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[12/22 22:08:27] detectron2 INFO: Command line arguments: Namespace(config_file='configs/clipart1k/vitb_shot5_clipart1k_finetune.yaml', resume=False, eval_only=False, num_gpus=4, controller=False, num_machines=1, machine_rank=0, dist_url='auto', opts=['MODEL.WEIGHTS', 'weights/trained/few-shot/vitb_0089999.pth', 'DE.OFFLINE_RPN_CONFIG', 'configs/RPN/mask_rcnn_R_50_C4_1x_ovd_FSD.yaml', 'OUTPUT_DIR', 'output/vitb/clipart1k_5shot/'])
[12/22 22:08:27] detectron2 INFO: Contents of args.config_file=configs/clipart1k/vitb_shot5_clipart1k_finetune.yaml:
_BASE_: ../Base-RCNN-C4.yaml
DE:
  CLASS_PROTOTYPES: prototypes_init/clipart1k_5shot.vitb14.bbox.p5.sk.pkl
  BG_PROTOTYPES: weights/initial/background/background_prototypes.vitb14.pth
  BG_CLS_LOSS_WEIGHT: 0.2
  TOPK: 5
  SET_CD_VITO: true
  ATTN_FUSE_RATIO: 0.7
MODEL:
  META_ARCHITECTURE: OpenSetDetectorWithExamples
  BACKBONE:
    NAME: build_dino_v2_vit
    TYPE: base    # base, small
  WEIGHTS: ''
  MASK_ON: false
  RPN:
    HEAD_NAME: StandardRPNHead
    IN_FEATURES: [res4]
  ROI_HEADS:
    SCORE_THRESH_TEST: 0.001
  ROI_BOX_HEAD:
    NAME: ''
    NUM_FC: 0
    POOLER_RESOLUTION: 7
    CLS_AGNOSTIC_BBOX_REG: true
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
DATASETS:
  TRAIN: ("clipart1k_5shot",)
  TEST: ("clipart1k_test",)
TEST:
  EVAL_PERIOD: 250
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.002
  STEPS: (100, 180)
  MAX_ITER: 250
  WARMUP_ITERS: 50
  CHECKPOINT_PERIOD: 250
INPUT:
  MIN_SIZE_TRAIN_SAMPLING: choice
  MIN_SIZE_TRAIN: (640, 672, 704, 736, 768, 800)
  MAX_SIZE_TRAIN: 1333
  MIN_SIZE_TEST: 800
  MAX_SIZE_TEST: 1333
  FORMAT: RGB


[12/22 22:08:32] detectron2.data.datasets.coco INFO: Loaded 92 images in COCO format from datasets/clipart1k/annotations/5_shot.json
[12/22 22:08:32] detectron2.data.build INFO: Removed 0 images with no usable annotations. 92 images left.
[12/22 22:08:32] detectron2.data.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
|   sheep    | 5            |    chair    | 5            |    boat     | 5            |
|   bottle   | 5            | diningtable | 5            |    sofa     | 5            |
|    cow     | 5            |  motorbike  | 5            |     car     | 5            |
| aeroplane  | 5            |     cat     | 5            |    train    | 5            |
|   person   | 5            |   bicycle   | 5            | pottedplant | 5            |
|    bird    | 5            |     dog     | 5            |     bus     | 5            |
| tvmonitor  | 5            |    horse    | 5            |             |              |
|   total    | 100          |             |              |             |              |[0m
[12/22 22:08:32] detectron2.data.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[12/22 22:08:32] detectron2.data.build INFO: Using training sampler TrainingSampler
[12/22 22:08:32] detectron2.data.common INFO: Serializing 92 elements to byte tensors and concatenating them all ...
[12/22 22:08:32] detectron2.data.common INFO: Serialized dataset takes 0.02 MiB
[12/22 22:08:32] fvcore.common.checkpoint INFO: [Checkpointer] Loading from weights/trained/few-shot/vitb_0089999.pth ...
[12/22 22:08:33] fvcore.common.checkpoint WARNING: Skip loading parameter 'test_class_weight' to the model due to incompatible shapes: (80, 768) in the checkpoint but (20, 768) in the model! You might want to double check if this is expected.
[12/22 22:08:33] fvcore.common.checkpoint WARNING: Some model parameters or buffers are not found in the checkpoint:
[34madapter.proto_center_attn.attention_weights.0.{bias, weight}[0m
[34madapter.proto_center_attn.fc.{bias, weight}[0m
[34mbg_tokens.weight[0m
[34mclass_weights.weight[0m
[34mdomain_prompter.weight[0m
[34mprototype_classifier.linear.{bias, weight}[0m
[34mtest_class_weight[0m
[12/22 22:08:33] fvcore.common.checkpoint WARNING: The checkpoint state_dict contains keys that are not used by the model:
  [35mtrain_class_weight[0m
[12/22 22:08:33] detectron2.engine.train_loop INFO: Starting training from iteration 0
[12/22 22:13:16] detectron2.engine.hooks INFO: Overall training speed: 248 iterations in 0:04:33 (1.1046 s / it)
[12/22 22:13:16] detectron2.engine.hooks INFO: Total training time: 0:04:33 (0:00:00 on hooks)
[12/22 22:13:16] detectron2.data.datasets.coco INFO: Loaded 500 images in COCO format from datasets/clipart1k/annotations/test.json
[12/22 22:13:16] detectron2.data.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
|   sheep    | 33           |    chair    | 163          |    boat     | 74           |
|   bottle   | 74           | diningtable | 50           |    sofa     | 21           |
|    cow     | 21           |  motorbike  | 10           |     car     | 84           |
| aeroplane  | 41           |     cat     | 23           |    train    | 26           |
|   person   | 566          |   bicycle   | 16           | pottedplant | 94           |
|    bird    | 124          |     dog     | 24           |     bus     | 8            |
| tvmonitor  | 40           |    horse    | 34           |             |              |
|   total    | 1526         |             |              |             |              |[0m
[12/22 22:13:16] detectron2.data.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[12/22 22:13:16] detectron2.data.common INFO: Serializing 500 elements to byte tensors and concatenating them all ...
[12/22 22:13:16] detectron2.data.common INFO: Serialized dataset takes 0.18 MiB
[12/22 22:13:16] detectron2.evaluation.evaluator INFO: Start inference on 125 batches
[12/23 19:26:27] detectron2 INFO: Rank of current process: 3. World size: 4
[12/23 19:26:28] detectron2 INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.9.23 | packaged by conda-forge | (main, Jun  4 2025, 17:57:12) [GCC 13.3.0]
numpy                   1.22.4
detectron2              RegionCLIP @/data2/user/2025/flf/project_zyh/CDFSOD-benchmark/tools/../detectron2
Compiler                GCC 10.5
CUDA compiler           CUDA 11.8
detectron2 arch flags   8.6
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.13.1+cu117 @/home/fee/sdb_flf/miniconda3/envs/cdfsod/lib/python3.9/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0,1,2,3             NVIDIA GeForce RTX 4090 (arch=8.9)
CUDA_HOME               /usr/local/cuda-11.8
Pillow                  9.5.0
torchvision             0.14.1+cu117 @/home/fee/sdb_flf/miniconda3/envs/cdfsod/lib/python3.9/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.5.post20221221
iopath                  0.1.8
cv2                     Not found
----------------------  ----------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.9.7  (built against CUDA 11.8)
    - Built with CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[12/23 19:26:28] detectron2 INFO: Command line arguments: Namespace(config_file='configs/clipart1k/vitb_shot5_clipart1k_finetune.yaml', resume=False, eval_only=True, num_gpus=4, controller=False, num_machines=1, machine_rank=0, dist_url='auto', opts=['MODEL.WEIGHTS', 'output/vitb/clipart1k_5shot/model_final.pth', 'DE.OFFLINE_RPN_CONFIG', 'configs/RPN/mask_rcnn_R_50_C4_1x_ovd_FSD.yaml', 'OUTPUT_DIR', 'output/vitb/clipart1k_5shot/', 'SOLVER.IMS_PER_BATCH', '4'])
[12/23 19:26:28] detectron2 INFO: Contents of args.config_file=configs/clipart1k/vitb_shot5_clipart1k_finetune.yaml:
_BASE_: ../Base-RCNN-C4.yaml
DE:
  CLASS_PROTOTYPES: prototypes_init/clipart1k_5shot.vitb14.bbox.p5.sk.pkl
  BG_PROTOTYPES: weights/initial/background/background_prototypes.vitb14.pth
  BG_CLS_LOSS_WEIGHT: 0.2
  TOPK: 5
  SET_CD_VITO: true
  ATTN_FUSE_RATIO: 0.7
MODEL:
  META_ARCHITECTURE: OpenSetDetectorWithExamples
  BACKBONE:
    NAME: build_dino_v2_vit
    TYPE: base    # base, small
  WEIGHTS: ''
  MASK_ON: false
  RPN:
    HEAD_NAME: StandardRPNHead
    IN_FEATURES: [res4]
  ROI_HEADS:
    SCORE_THRESH_TEST: 0.001
  ROI_BOX_HEAD:
    NAME: ''
    NUM_FC: 0
    POOLER_RESOLUTION: 7
    CLS_AGNOSTIC_BBOX_REG: true
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
DATASETS:
  TRAIN: ("clipart1k_5shot",)
  TEST: ("clipart1k_test",)
TEST:
  EVAL_PERIOD: 250
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.002
  STEPS: (100, 180)
  MAX_ITER: 250
  WARMUP_ITERS: 50
  CHECKPOINT_PERIOD: 250
INPUT:
  MIN_SIZE_TRAIN_SAMPLING: choice
  MIN_SIZE_TRAIN: (640, 672, 704, 736, 768, 800)
  MAX_SIZE_TRAIN: 1333
  MIN_SIZE_TEST: 800
  MAX_SIZE_TEST: 1333
  FORMAT: RGB


[12/23 19:26:33] fvcore.common.checkpoint INFO: [Checkpointer] Loading from output/vitb/clipart1k_5shot/model_final.pth ...
[12/23 19:26:38] detectron2.data.datasets.coco INFO: Loaded 500 images in COCO format from datasets/clipart1k/annotations/test.json
[12/23 19:26:38] detectron2.data.build INFO: Distribution of instances among all 20 categories:
|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
|   sheep    | 33           |    chair    | 163          |    boat     | 74           |
|   bottle   | 74           | diningtable | 50           |    sofa     | 21           |
|    cow     | 21           |  motorbike  | 10           |     car     | 84           |
| aeroplane  | 41           |     cat     | 23           |    train    | 26           |
|   person   | 566          |   bicycle   | 16           | pottedplant | 94           |
|    bird    | 124          |     dog     | 24           |     bus     | 8            |
| tvmonitor  | 40           |    horse    | 34           |             |              |
|   total    | 1526         |             |              |             |              |
[12/23 19:26:38] detectron2.data.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[12/23 19:26:38] detectron2.data.common INFO: Serializing 500 elements to byte tensors and concatenating them all ...
[12/23 19:26:38] detectron2.data.common INFO: Serialized dataset takes 0.18 MiB
[12/23 19:26:38] detectron2.evaluation.evaluator INFO: Start inference on 125 batches
[12/23 19:27:19] detectron2.evaluation.evaluator INFO: Inference done 11/125. Dataloading: 0.0012 s / iter. Inference: 1.8791 s / iter. Eval: 0.0003 s / iter. Total: 1.8807 s / iter. ETA=0:03:34
[12/23 19:27:26] detectron2.evaluation.evaluator INFO: Inference done 15/125. Dataloading: 0.0015 s / iter. Inference: 1.7700 s / iter. Eval: 0.0003 s / iter. Total: 1.7719 s / iter. ETA=0:03:14
[12/23 19:27:32] detectron2.evaluation.evaluator INFO: Inference done 18/125. Dataloading: 0.0015 s / iter. Inference: 1.8236 s / iter. Eval: 0.0003 s / iter. Total: 1.8256 s / iter. ETA=0:03:15
[12/23 19:27:37] detectron2.evaluation.evaluator INFO: Inference done 20/125. Dataloading: 0.0016 s / iter. Inference: 1.9175 s / iter. Eval: 0.0003 s / iter. Total: 1.9195 s / iter. ETA=0:03:21
[12/23 19:27:42] detectron2.evaluation.evaluator INFO: Inference done 22/125. Dataloading: 0.0017 s / iter. Inference: 2.0148 s / iter. Eval: 0.0003 s / iter. Total: 2.0169 s / iter. ETA=0:03:27
[12/23 19:27:47] detectron2.evaluation.evaluator INFO: Inference done 25/125. Dataloading: 0.0017 s / iter. Inference: 1.9754 s / iter. Eval: 0.0003 s / iter. Total: 1.9776 s / iter. ETA=0:03:17
[12/23 19:27:53] detectron2.evaluation.evaluator INFO: Inference done 29/125. Dataloading: 0.0017 s / iter. Inference: 1.8791 s / iter. Eval: 0.0003 s / iter. Total: 1.8813 s / iter. ETA=0:03:00
[12/23 19:27:59] detectron2.evaluation.evaluator INFO: Inference done 32/125. Dataloading: 0.0017 s / iter. Inference: 1.8826 s / iter. Eval: 0.0003 s / iter. Total: 1.8848 s / iter. ETA=0:02:55
[12/23 19:28:04] detectron2.evaluation.evaluator INFO: Inference done 34/125. Dataloading: 0.0017 s / iter. Inference: 1.9311 s / iter. Eval: 0.0003 s / iter. Total: 1.9334 s / iter. ETA=0:02:55
[12/23 19:28:09] detectron2.evaluation.evaluator INFO: Inference done 36/125. Dataloading: 0.0017 s / iter. Inference: 1.9696 s / iter. Eval: 0.0003 s / iter. Total: 1.9718 s / iter. ETA=0:02:55
[12/23 19:28:16] detectron2.evaluation.evaluator INFO: Inference done 39/125. Dataloading: 0.0017 s / iter. Inference: 1.9915 s / iter. Eval: 0.0003 s / iter. Total: 1.9937 s / iter. ETA=0:02:51
[12/23 19:28:21] detectron2.evaluation.evaluator INFO: Inference done 41/125. Dataloading: 0.0017 s / iter. Inference: 2.0214 s / iter. Eval: 0.0003 s / iter. Total: 2.0236 s / iter. ETA=0:02:49
[12/23 19:28:26] detectron2.evaluation.evaluator INFO: Inference done 44/125. Dataloading: 0.0017 s / iter. Inference: 2.0135 s / iter. Eval: 0.0003 s / iter. Total: 2.0157 s / iter. ETA=0:02:43
[12/23 19:28:33] detectron2.evaluation.evaluator INFO: Inference done 47/125. Dataloading: 0.0017 s / iter. Inference: 2.0286 s / iter. Eval: 0.0003 s / iter. Total: 2.0309 s / iter. ETA=0:02:38
[12/23 19:28:39] detectron2.evaluation.evaluator INFO: Inference done 50/125. Dataloading: 0.0017 s / iter. Inference: 2.0210 s / iter. Eval: 0.0003 s / iter. Total: 2.0233 s / iter. ETA=0:02:31
[12/23 19:28:46] detectron2.evaluation.evaluator INFO: Inference done 53/125. Dataloading: 0.0017 s / iter. Inference: 2.0384 s / iter. Eval: 0.0003 s / iter. Total: 2.0407 s / iter. ETA=0:02:26
[12/23 19:28:52] detectron2.evaluation.evaluator INFO: Inference done 56/125. Dataloading: 0.0018 s / iter. Inference: 2.0393 s / iter. Eval: 0.0003 s / iter. Total: 2.0415 s / iter. ETA=0:02:20
[12/23 19:28:58] detectron2.evaluation.evaluator INFO: Inference done 59/125. Dataloading: 0.0017 s / iter. Inference: 2.0307 s / iter. Eval: 0.0003 s / iter. Total: 2.0329 s / iter. ETA=0:02:14
[12/23 19:29:04] detectron2.evaluation.evaluator INFO: Inference done 62/125. Dataloading: 0.0017 s / iter. Inference: 2.0352 s / iter. Eval: 0.0003 s / iter. Total: 2.0375 s / iter. ETA=0:02:08
[12/23 19:29:10] detectron2.evaluation.evaluator INFO: Inference done 65/125. Dataloading: 0.0017 s / iter. Inference: 2.0306 s / iter. Eval: 0.0003 s / iter. Total: 2.0329 s / iter. ETA=0:02:01
[12/23 19:29:16] detectron2.evaluation.evaluator INFO: Inference done 68/125. Dataloading: 0.0017 s / iter. Inference: 2.0274 s / iter. Eval: 0.0003 s / iter. Total: 2.0297 s / iter. ETA=0:01:55
[12/23 19:29:21] detectron2.evaluation.evaluator INFO: Inference done 72/125. Dataloading: 0.0017 s / iter. Inference: 1.9885 s / iter. Eval: 0.0003 s / iter. Total: 1.9908 s / iter. ETA=0:01:45
[12/23 19:29:28] detectron2.evaluation.evaluator INFO: Inference done 75/125. Dataloading: 0.0017 s / iter. Inference: 1.9957 s / iter. Eval: 0.0003 s / iter. Total: 1.9979 s / iter. ETA=0:01:39
[12/23 19:29:34] detectron2.evaluation.evaluator INFO: Inference done 78/125. Dataloading: 0.0017 s / iter. Inference: 1.9985 s / iter. Eval: 0.0003 s / iter. Total: 2.0007 s / iter. ETA=0:01:34
[12/23 19:29:39] detectron2.evaluation.evaluator INFO: Inference done 82/125. Dataloading: 0.0017 s / iter. Inference: 1.9600 s / iter. Eval: 0.0003 s / iter. Total: 1.9623 s / iter. ETA=0:01:24
[12/23 19:29:44] detectron2.evaluation.evaluator INFO: Inference done 84/125. Dataloading: 0.0017 s / iter. Inference: 1.9766 s / iter. Eval: 0.0003 s / iter. Total: 1.9788 s / iter. ETA=0:01:21
[12/23 19:29:51] detectron2.evaluation.evaluator INFO: Inference done 88/125. Dataloading: 0.0017 s / iter. Inference: 1.9577 s / iter. Eval: 0.0003 s / iter. Total: 1.9599 s / iter. ETA=0:01:12
[12/23 19:29:56] detectron2.evaluation.evaluator INFO: Inference done 91/125. Dataloading: 0.0017 s / iter. Inference: 1.9481 s / iter. Eval: 0.0003 s / iter. Total: 1.9504 s / iter. ETA=0:01:06
[12/23 19:30:03] detectron2.evaluation.evaluator INFO: Inference done 95/125. Dataloading: 0.0017 s / iter. Inference: 1.9425 s / iter. Eval: 0.0003 s / iter. Total: 1.9447 s / iter. ETA=0:00:58
[12/23 19:30:09] detectron2.evaluation.evaluator INFO: Inference done 98/125. Dataloading: 0.0017 s / iter. Inference: 1.9487 s / iter. Eval: 0.0003 s / iter. Total: 1.9509 s / iter. ETA=0:00:52
[12/23 19:30:15] detectron2.evaluation.evaluator INFO: Inference done 101/125. Dataloading: 0.0017 s / iter. Inference: 1.9428 s / iter. Eval: 0.0003 s / iter. Total: 1.9450 s / iter. ETA=0:00:46
[12/23 19:30:20] detectron2.evaluation.evaluator INFO: Inference done 104/125. Dataloading: 0.0017 s / iter. Inference: 1.9438 s / iter. Eval: 0.0003 s / iter. Total: 1.9461 s / iter. ETA=0:00:40
[12/23 19:30:27] detectron2.evaluation.evaluator INFO: Inference done 107/125. Dataloading: 0.0017 s / iter. Inference: 1.9472 s / iter. Eval: 0.0003 s / iter. Total: 1.9494 s / iter. ETA=0:00:35
[12/23 19:30:33] detectron2.evaluation.evaluator INFO: Inference done 110/125. Dataloading: 0.0017 s / iter. Inference: 1.9523 s / iter. Eval: 0.0003 s / iter. Total: 1.9545 s / iter. ETA=0:00:29
[12/23 19:30:39] detectron2.evaluation.evaluator INFO: Inference done 113/125. Dataloading: 0.0017 s / iter. Inference: 1.9488 s / iter. Eval: 0.0003 s / iter. Total: 1.9511 s / iter. ETA=0:00:23
[12/23 19:30:45] detectron2.evaluation.evaluator INFO: Inference done 117/125. Dataloading: 0.0017 s / iter. Inference: 1.9328 s / iter. Eval: 0.0003 s / iter. Total: 1.9351 s / iter. ETA=0:00:15
[12/23 19:30:52] detectron2.evaluation.evaluator INFO: Inference done 120/125. Dataloading: 0.0017 s / iter. Inference: 1.9459 s / iter. Eval: 0.0003 s / iter. Total: 1.9481 s / iter. ETA=0:00:09
[12/23 19:30:58] detectron2.evaluation.evaluator INFO: Inference done 123/125. Dataloading: 0.0017 s / iter. Inference: 1.9442 s / iter. Eval: 0.0003 s / iter. Total: 1.9464 s / iter. ETA=0:00:03
[12/23 19:31:22] detectron2.evaluation.evaluator INFO: Total inference time: 0:04:14.292930 (2.119108 s / iter per device, on 4 devices)
[12/23 19:31:22] detectron2.evaluation.evaluator INFO: Total inference pure compute time: 0:03:53 (1.949988 s / iter per device, on 4 devices)
